# ğŸ§´ AI Skincare Assistant: Diagnosis & Consultation

![Python](https://img.shields.io/badge/Python-3.10%2B-blue)
![TensorFlow](https://img.shields.io/badge/TensorFlow-Keras-orange)
![LangChain](https://img.shields.io/badge/LangChain-RAG-green)
![Kaggle](https://img.shields.io/badge/Kaggle-Models-blue)
![HuggingFace](https://img.shields.io/badge/HuggingFace-Mistral--7B-yellow)

## ğŸ“– Overview

This project is a comprehensive AI solution for skincare analysis and consultation. It bridges the gap between identifying skin issues and finding the right treatment using a hybrid architecture:

1.  **Visual Diagnosis Model (Local):** A Deep Learning model (VGG16 or Custom CNN) runs locally within the app to classify skin conditions with high accuracy.
2.  **Intelligent Chatbot (Remote via Kaggle):** A RAG-based system powered by **Mistral-7B/70B** running on Kaggle's GPU accelerators. It acts as an API backend to provide context-aware advice based on a custom knowledge base.

## ğŸ“‚ Project Structure

```text
â”‚   app.py
â”‚   README.md
â”‚   requirements.txt
â”‚
â”œâ”€â”€â”€docs
â”‚       AI Skin Analyzer - for Skin health.pdf
â”‚
â”œâ”€â”€â”€evaluation
â”‚   â”œâ”€â”€â”€Custom CNN
â”‚   â”‚       classification_report.txt
â”‚   â”‚       Confusion matrix.png
â”‚   â”‚
â”‚   â”œâ”€â”€â”€ResNet50
â”‚   â”‚       classification_report.txt
â”‚   â”‚       Confusion matrix.png
â”‚   â”‚
â”‚   â””â”€â”€â”€VGG16
â”‚           classification_report.txt
â”‚           Confusion matrix.png
â”‚
â”œâ”€â”€â”€llm_knowledge_base
â”‚       routine.csv
â”‚       skin issues.csv
â”‚       skin products.csv
â”‚
â”œâ”€â”€â”€notebooks
â”‚       Chatbot Final.ipynb
â”‚       ResNet50 - 94%.ipynb
â”‚       Skin Condition Classification Custom CNN 94%.ipynb
â”‚       VGG16 - 95%.ipynb
â”‚
â”œâ”€â”€â”€Screanshots of Streamlit
â”‚       Screenshot 2025-12-05 212142.png
â”‚       Screenshot 2025-12-05 212719.png
â”‚       Screenshot 2025-12-05 212812.png
â”‚       Screenshot 2025-12-05 213226.png
â”‚       Screenshot 2025-12-05 213249.png
â”‚       Screenshot 2025-12-05 213447.png
â”‚       Screenshot 2025-12-05 213809.png
â”‚       Screenshot 2025-12-05 214008.png
â”‚       Screenshot 2025-12-05 214611.png
â”‚       Screenshot 2025-12-05 214931.png
â”‚
â””â”€â”€â”€test_images
        360_F_1419958115_fL6umGDMYecFoOR9akjIFwkMQXtAIUO5.jpg
        acne-severe.jpg
        closeup-asian-woman-with-dark-spots-freckles-problems-scaled.jpg
        Des-pores-dilateÌs-sur-une-peau-grasse-1080x1080.jpg
        filtersquality90.jpg
        iStock-508211701-1.jpg
```

## ğŸ“‚ Dataset Sources

The project relies on high-quality datasets for training and knowledge retrieval:

*   **ğŸ“¸ Image Dataset:** [Skin Issues Version 2 (Balanced)](https://www.kaggle.com/datasets/ahmedismaiil/skin-issues-version-2-dataset-balanced)  
    *Contains ~9,700 balanced images across 5 classes.*
*   **ğŸ“„ Text Data:** Custom CSV datasets (Routine, Products, Issues) located in the `llm_knowledge_base` folder.

## ğŸ§  Image Classification Models

We provide two pre-trained models hosted on Kaggle. You must download **one** of these to use in the local Streamlit app (`app.py`).

| Model Architecture | Accuracy | Download Link | Notes |
| :--- | :---: | :--- | :--- |
| **VGG16 (Recommended)** | **95%** | [**Download VGG16 Model**](https://www.kaggle.com/models/ahmedismaiil/vgg-16-95-acc-skin-issues) | Best performance, slightly larger file size. |
| **Custom CNN** | **94%** | [**Download CNN Model**](https://www.kaggle.com/models/ahmedismaiil/skin-issues-model-94-accuracy) | Lightweight alternative. |

**Instructions:**
1. Download your preferred model file (`.h5` or `.keras`).
2. Place it in the root directory of this repository.
3. Update the `MODEL_PATH` variable in `app.py` if necessary.

---

## ğŸš€ Installation & Hybrid Deployment

Because the LLM (Mistral) requires high GPU memory (VRAM), this project uses a split setup: **Chatbot Backend on Kaggle** and **Frontend App on Local Device**.

### Part 1: Chatbot Backend (Run on Kaggle)

1.  **Open the Chatbot Notebook:** Upload `notebooks/Chatbot Final.ipynb` to Kaggle.
2.  **Upload Knowledge Base:** Upload the CSV files from the `llm_knowledge_base` folder to the Kaggle environment (Input section).
3.  **Enable GPU:** Set the Kaggle accelerator to **GPU T4 x2** (or P100) to handle the Mistral model.
4.  **Run All Cells:** Execute the notebook. It utilizes `FastAPI` and `ngrok` to expose a public HTTP endpoint.
5.  **Copy the Endpoint:** Look for the public URL generated by ngrok at the end of the notebook (e.g., `https://xxxx-xx-xx-xx.ngrok-free.app`).

### Part 2: Visual App (Run Locally)

1.  **Clone Repository:**
    ```bash
    git clone https://github.com/ahmedismaiill/AI-Skin-Assistant.git
    cd ai-skincare-assistant
    ```

2.  **Install Dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Configure Endpoint:**
    Open `app.py` and locate the API URL variable. Paste the URL you copied from Kaggle in Part 1.
    ```python
    # In app.py
    CHATBOT_API_URL = "https://your-ngrok-url-from-kaggle.ngrok-free.app/chat"
    ```

4.  **Run the App:**
    ```bash
    streamlit run app.py
    ```

## âœ¨ Features

### ğŸ‘ï¸ Visual Analysis
*   **Multi-Class Classification:** Identifies Acne, Dark Spots, Wrinkles, Pores, and Blackheads.
*   **Real-time Prediction:** Upload an image to get instant results with confidence scores.

### ğŸ’¬ Conversational AI
*   **RAG Architecture:** Retrieves relevant skincare routines and product recommendations from the CSV knowledge base.
*   **Smart Routing:** Filters out non-skincare related questions.
*   **Context Aware:** Maintains conversation history for follow-up questions.

## ğŸ“Š Performance Metrics (VGG16)

| Class | Precision | Recall | F1-Score |
| :--- | :---: | :---: | :---: |
| **Acne** | 0.91 | 0.96 | 0.94 |
| **Dark Spots** | 0.94 | 0.93 | 0.94 |
| **Wrinkles** | 0.95 | 0.97 | 0.96 |
| **Pores** | 0.99 | 0.98 | 0.98 |
| **Blackheads** | 0.93 | 0.88 | 0.91 |

## ğŸ¤ Contributing
Contributions are welcome! Please open an issue or submit a pull request for improvements in the model architecture or UI implementations.
